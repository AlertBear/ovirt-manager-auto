<?xml-stylesheet type="text/xsl" href="table.xslt"?>
<input>
<test_case>
    <test_name>START_GROUP: SETUP-ENV</test_name>
    <test_action/>
    <parameters></parameters>
    <positive>NONE</positive>
    <run>YES</run>
</test_case>
<test_case>
    <test_name>Create Data Center</test_name>
<test_action>addDataCenter</test_action>
<parameters>name='{dc_prefix}',storage_type='e{storage_type_nfs}',version='{compatibility_version}'</parameters>
<positive>TRUE</positive>
<run>yes</run>
</test_case>
<test_case>
    <test_name>Create Cluster With Default Parameters</test_name>
    <test_action>addCluster</test_action>
    <parameters>name='{cluster_prefix}',cpu='{cpu_name}',data_center='{dc_prefix}',version='{compatibility_version}',on_error='migrate'</parameters>
    <positive>TRUE</positive>
    <run>yes</run>
</test_case>
<test_case>
    <test_name>Add Host</test_name>
    <test_action>addHost</test_action>
    <parameters>name='{vds[0]}', root_password='{vds_password[0]}', cluster='{cluster_prefix}', wait=False, vdcPort='{port}'</parameters>
    <positive>TRUE</positive>
    <vital>TRUE</vital>
    <run>yes</run>
</test_case>
<test_case>
    <test_name>Wait for host to become UP</test_name>
    <test_action>waitForHostsStates</test_action>
    <parameters>names='{vds[0]}'</parameters>
    <positive>TRUE</positive>
    <vital>TRUE</vital>
    <run>yes</run>
</test_case>
<test_case>
    <test_name>Create Data Storage Domain NFS</test_name>
    <test_action>addStorageDomain</test_action>
    <parameters>name='{sd_name}',type='e{storage_dom_type_data}',storage_type='e{storage_type_nfs}',address='{data_domain_address}',host='{vds[0]}',path='{data_domain_path}'</parameters>
    <positive>TRUE</positive>
    <run>yes</run>
</test_case>
<test_case>
    <test_name>Attach Data Storage Domain to Data Center</test_name>
    <test_action>attachStorageDomain</test_action>
    <parameters>datacenter='{dc_prefix}',storagedomain='{sd_name}'</parameters>
    <positive>TRUE</positive>
    <run>yes</run>
</test_case>
<test_case>
    <test_name>END_GROUP: SETUP-ENV</test_name>
    <test_action/>
    <parameters></parameters>
    <positive>NONE</positive>
    <run>YES</run>
</test_case>
<test_case>
    <test_name>START_GROUP: SETUP</test_name>
    <test_action/>
    <parameters></parameters>
    <positive>NONE</positive>
    <run>YES</run>
</test_case>
<test_case>
    <test_name>Create VM to create Template from it</test_name>
    <test_action>addVm</test_action>
    <parameters>name='{vm_for_template}', description='vm to create template', cluster='{cluster_prefix}', template= 'Blank', display_type='{display_type}'</parameters>
    <positive>TRUE</positive>
    <run>yes</run>
</test_case>
<test_case>
   <test_name>Add disk to vm</test_name>
   <test_action>addDiskToVm</test_action>
   <parameters>vm='{vm_for_template}',size=3221225472,storagedomain='{sd_name}',type='e{disk_type_system}',format='e{format_raw}',interface='e{interface_ide}',bootable='true'</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
</test_case>
<test_case>
    <test_name>Add NIC to VM to allow boot</test_name>
    <test_action>addNic</test_action>
    <parameters>vm='{vm_for_template}', name='nic1', network='rhevm'</parameters>
    <positive>TRUE</positive>
    <run>yes</run>
</test_case>
<test_case>
    <test_name>Install RHEL from network; (short profile) </test_name>
    <test_action>unattendedInstallation</test_action>
    <parameters>vm='{vm_for_template}', nic='nic1', image='{cobbler_profile}', cobblerAddress='{cobbler_address}', cobblerUser='{cobbler_user}', cobblerPasswd='{cobbler_passwd}'</parameters>
    <positive>TRUE</positive>
    <run>yes</run>
</test_case>
<test_case>
   <test_name>Wait for information from the template VM (guestInfo)</test_name>
   <test_action>waitForIP</test_action>
   <parameters>vm='{vm_for_template}', timeout=1200, sleep=10</parameters>
   <positive>NONE</positive>
   <fetch_output>ip->guest_ip</fetch_output>
   <run>yes</run>
 </test_case>
 <test_case>
    <test_name>set linux vm persistent</test_name>
    <test_action>setPersistentNetwork</test_action>
    <parameters>host=%guest_ip%, password='{passwd}'</parameters>
    <positive>NONE</positive>
    <run>yes</run>
</test_case>
<test_case>
    <test_name>Stop VM, so we can create template from it.</test_name>
    <test_action>stopVm</test_action>
    <parameters>vm='{vm_for_template}'</parameters>
    <positive>TRUE</positive>
    <run>yes</run>
</test_case>
<test_case>
    <test_name>Create Template From VM</test_name>
    <test_action>createTemplate</test_action>
    <parameters>vm='{vm_for_template}',name='{vm_template_for_test}',cluster='{cluster_prefix}'</parameters>
    <positive>TRUE</positive>
    <run>yes</run>
</test_case>
<test_case>
    <test_name>END_GROUP: SETUP</test_name>
    <test_action/>
    <parameters></parameters>
    <positive>NONE</positive>
    <run>YES</run>
</test_case>
<test_case>
    <test_name>START_GROUP: DEFINE-CUSTOM-PROPERTIES</test_name>
    <test_action/>
    <parameters></parameters>
    <positive>NONE</positive>
    <run>YES</run>
</test_case>
<test_case>
    <test_name>Define a custom property: custom_hook=^[0-9]+$</test_name>
    <test_action>runMachineCommand</test_action>
    <parameters>ip='{vdc}', user='{username}', password='{passwd}', cmd="rhevm-config -s UserDefinedVMProperties='auto_custom_hook=^[0-9]+$' --cver="+'{compatibility_version}'</parameters>
    <positive>TRUE</positive>
    <run>yes</run>
</test_case>
<test_case>
    <test_name>Add custom properties for vnics</test_name>
    <test_action>runMachineCommand</test_action>
    <parameters>ip='{vdc}', user='{username}', password='{passwd}',
    cmd='engine-config -s CustomDeviceProperties="{type=interface;prop={speed=^([0-9]{1,5})$;port_mirroring=^(True|False)$;bandwidth=^([0-9]{1,5})$}}" --cver='+'{compatibility_version}', cmd_list=False</parameters>
    <positive>True</positive>
    <run>yes</run>
</test_case>
<test_case>
    <test_name>Restart ovirt_engine to make custom_hook available</test_name>
    <test_action>runMachineCommand</test_action>
    <parameters>ip='{vdc}', user='{username}', password='{passwd}', cmd="service ovirt-engine restart"</parameters>
    <positive>TRUE</positive>
    <run>yes</run>
</test_case>
<test_case>
    <test_name>Sleep to let Ovirt reboots</test_name>
    <test_action>sleep</test_action>
    <parameters>seconds=30</parameters>
    <positive>NONE</positive>
    <run>yes</run>
</test_case>
<test_case>
    <test_name>END_GROUP: DEFINE-CUSTOM-PROPERTIES</test_name>
    <test_action/>
    <parameters></parameters>
    <positive>NONE</positive>
    <run>YES</run>
</test_case>
</input>
