<?xml-stylesheet type="text/xsl" href="table.xslt"?>
<input>
<test_case>
    <test_name>START_GROUP: PAYLOAD_FLOPPY_VIA_CREATE</test_name>
    <test_action/>
    <parameters></parameters>
    <positive>NONE</positive>
    <run>YES</run>
</test_case>
<test_case>
    <test_name>Create VM from template to test payload type FLOPPY via CREATE</test_name>
    <test_action>addVm</test_action>
    <parameters>name='floppy', description='payload floppy test', cluster='{cluster_name}', template= 'payload-template-for-test', display_type='{display_type}', payloads=[('floppy', 'file.create.floppy','floppy create payload!')]</parameters>
    <positive>TRUE</positive>
    <run>yes</run>
</test_case>
<test_case>
   <test_name>Start VM to test payload floppy status</test_name>
   <test_action>startVm</test_action>
   <parameters>vm='floppy'</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
</test_case>
<test_case>
   <test_name>Wait for VM to become up to fetch the IP</test_name>
   <test_action>waitForIP</test_action>
   <parameters>vm='floppy', timeout=1200, sleep=10</parameters>
   <positive>NONE</positive>
   <run>yes</run>
   <fetch_output>ip->guest_ip</fetch_output>
</test_case>
<test_case>
	<test_name>modprobe floppy and mount /dev/fd0 and create a temp directory</test_name>
   <test_action>runMachineCommand</test_action>
   <parameters>ip=%guest_ip%, user='{vm_username}', password='{vm_password}', cmd="modprobe floppy; mkdir /tmp/floppy_payload; mount /dev/fd0 /tmp/floppy_payload"</parameters>
   <positive>true</positive>
   <run>yes</run>
</test_case>
<test_case>
    <test_name>Verify file content and existence on the VM (floppy success)</test_name>
    <test_action>checkForFileExistenceAndContent</test_action>
    <parameters>ip=%guest_ip%,password='{vm_password}',filename='/tmp/floppy_payload/file.create.floppy',content='floppy create payload!',user='{vm_username}'</parameters>
    <positive>True</positive>
    <run>yes</run>
</test_case>
<test_case>
	<test_name>umount /dev/fd0 and delete temp directory</test_name>
   <test_action>runMachineCommand</test_action>
   <parameters>ip=%guest_ip%, user='{vm_username}', password='{vm_password}', cmd="umount /dev/fd0; rm -fr /tmp/floppy_payload"</parameters>
   <positive>True</positive>
   <run>yes</run>
</test_case>
<test_case>
    <test_name>Stop VM, so we can remove the VM.</test_name>
    <test_action>stopVm</test_action>
    <parameters>vm='floppy'</parameters>
    <positive>TRUE</positive>
    <run>yes</run>
</test_case>
<test_case>
   <test_name>Remove VM floppy</test_name>
   <test_action>removeVm</test_action>
   <parameters>vm='floppy', wait=True</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
</test_case>
<test_case>
    <test_name>END_GROUP: PAYLOAD_FLOPPY_VIA_CREATE</test_name>
    <test_action/>
    <parameters></parameters>
    <positive>NONE</positive>
    <run>YES</run>
</test_case>
</input>
