<?xml-stylesheet type="text/xsl" href="table.xslt"?>
<input>
<test_case>
    <test_name>START_GROUP: PAYLOAD_CDROM_VIA_UPDATE</test_name>
    <test_action/>
    <parameters></parameters>
    <positive>NONE</positive>
    <run>NO</run>
</test_case>
<test_case>
    <test_name>Create VM from template to test both payload via UPDATE</test_name>
    <test_action>addVm</test_action>
    <parameters>name='cdrom-update', description='payloads', cluster='{cluster_name}', template= 'payload-template-for-test', display_type='{display_type}' </parameters>
    <positive>TRUE</positive>
    <BZ>875623</BZ>
    <run>yes</run>
</test_case>
<test_case>
    <test_name>update with payload cdrom</test_name>
    <test_action>updateVm</test_action>
    <parameters>vm='cdrom-update',payloads=[('cdrom','file.update.cdrom','cdrom update!')]</parameters>
    <positive>TRUE</positive>
    <BZ>875623</BZ>
    <run>yes</run>
</test_case>
<test_case>
    <test_name>Sleep</test_name>
    <test_action>sleep</test_action>
    <parameters>seconds=15</parameters>
    <positive>NONE</positive>
    <BZ>875623</BZ>
    <run>yes</run>
</test_case>
<test_case>
   <test_name>Start VM that was update with payload type=cdrom</test_name>
   <test_action>startVm</test_action>
   <parameters>vm='cdrom-update'</parameters>
   <positive>TRUE</positive>
   <BZ>875623</BZ>
   <run>yes</run>
</test_case>
<test_case>
   <test_name>Wait for VM to become up to fetch the IP</test_name>
   <test_action>waitForIP</test_action>
   <parameters>vm='cdrom-update', timeout=1200, sleep=10</parameters>
   <positive>NONE</positive>
   <BZ>875623</BZ>
   <run>yes</run>
   <fetch_output>ip->guest_ip</fetch_output>
</test_case>
<test_case>
   <test_name>run command on vm</test_name>
   <test_action>runMachineCommand</test_action>
   <parameters>ip=%guest_ip%, user='root', password='qum5net', cmd="mkdir /tmp/cdrom_payload; mount /dev/cdrom /tmp/cdrom_payload"</parameters>
   <positive>true</positive>
   <BZ>875623</BZ>
   <run>yes</run>
</test_case>
<test_case>
    <test_name>Check is file exists in the payload</test_name>
    <test_action>checkForFileExistenceAndContent</test_action>
    <parameters>ip=%guest_ip%,password='qum5net',filename='/tmp/cdrom_payload/file.update.cdrom',content='cdrom update!',user='root'</parameters>
    <positive>NONE</positive>
    <BZ>875623</BZ>
    <run>yes</run>
</test_case>
<test_case>
   <test_name>run command on vm</test_name>
   <test_action>runMachineCommand</test_action>
   <parameters>ip=%guest_ip%, user='root', password='qum5net', cmd="umount /dev/cdrom; rm -rf /tmp/cdrom_payload"</parameters>
   <positive>True</positive>
   <BZ>875623</BZ>
   <run>yes</run>
</test_case>
<test_case>
    <test_name>Stop VM, so we can remove the VM.</test_name>
    <test_action>stopVm</test_action>
    <parameters>vm='cdrom-update'</parameters>
    <positive>TRUE</positive>
    <BZ>875623</BZ>
    <run>yes</run>
</test_case>
<test_case>
   <test_name>Remove VM cd-update</test_name>
   <test_action>removeVm</test_action>
   <parameters>vm='cdrom-update', wait=True</parameters>
   <positive>TRUE</positive>
   <BZ>875623</BZ>
   <run>yes</run>
</test_case>
<test_case>
    <test_name>END_GROUP: PAYLOAD_CDROM_VIA_UPDATE</test_name>
    <test_action/>
    <parameters></parameters>
    <positive>NONE</positive>
    <run>NO</run>
</test_case>
</input>
