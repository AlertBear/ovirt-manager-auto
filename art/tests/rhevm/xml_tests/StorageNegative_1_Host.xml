<?xml version="1.0" encoding="UTF-8"?>
<!-- vim: set ts=3 sw=3 expandtab: -->
<?xml-stylesheet type="text/xsl" href="table.xslt"?>
<input xmlns:xi="http://www.w3.org/2001/XInclude">


<test_case>
   <test_name>START_GROUP: Test_setup</test_name>
   <test_action/>
   <parameters></parameters>
   <positive>NONE</positive>
   <run/>
</test_case>
<test_case>
   <test_name>Create ISCSI Data Center</test_name>
   <test_action>addDataCenter</test_action>
   <parameters>name='{data_center_name}',storage_type='e{storage_type_iscsi}',version='{compatibility_version}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>if('{data_center_type}' == 'e{storage_type_iscsi}')</run>
</test_case>
<test_case>
   <test_name>Create NFS Data Center</test_name>
   <test_action>addDataCenter</test_action>
   <parameters>name='{data_center_name}',storage_type='e{storage_type_nfs}',version='{compatibility_version}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
   <run>if('{data_center_type}' == 'e{storage_type_nfs}')</run>
</test_case>
<test_case>
   <test_name>Create Cluster</test_name>
   <test_action>addCluster</test_action>
   <parameters>name='{cluster_name}',cpu='{cpu_name}',version='{compatibility_version}',data_center='{data_center_name}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Add hosts</test_name>
   <test_action>addHost</test_action>
   <parameters>name='{vds}',root_password='{vds_password[0]}',cluster='{cluster_name}'</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
   <vital>FALSE</vital>
   <report>no</report>
   <run>forkfor({vds})</run>
</test_case>
<test_case>
   <test_name>END_GROUP: Test_setup</test_name>
   <test_action/>
   <parameters></parameters>
   <positive>NONE</positive>
   <run/>
</test_case>
<test_case>
   <test_name>START_GROUP: Create_Storages</test_name>
   <test_action/>
   <parameters></parameters>
   <positive>NONE</positive>
   <run/>
</test_case>
<test_case>
   <test_name>Create ISCSI Storage Domain</test_name>
   <test_action>addStorageDomain</test_action>
   <parameters>name='{storage_domain_name[0]}', type='e{storage_dom_type_data}',version='{compatibility_version}', host='{vds[0]}', lun='{lun}', lun_address='{lun_address}', lun_target='{lun_target}', lun_port=3260, storage_type='e{storage_type_iscsi}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>if('{data_center_type}'=='e{storage_type_iscsi}')</run>
</test_case>
<test_case>
   <test_name>Create additional ISCSI Storage Domain</test_name>
   <test_action>addStorageDomain</test_action>
   <parameters>name='{storage_domain_name[1]}', type='e{storage_dom_type_data}',version='{compatibility_version}', host='{vds[0]}', lun='{standby[0]}', lun_address='{standby_address[0]}', lun_target='{standby_target[0]}', lun_port=3260, storage_type='e{storage_type_iscsi}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>if('{data_center_type}'=='e{storage_type_iscsi}')</run>
</test_case>
<test_case>
   <test_name>Create NFS Storage Domain</test_name>
   <test_action>addStorageDomain</test_action>
   <parameters>name='{storage_domain_name[0]}', type='e{storage_dom_type_data}',version='{compatibility_version}', host='{vds[0]}', address='{nfs_address}', path='{nfs_path}', storage_type='e{storage_type_nfs}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>if('{data_center_type}'=='e{storage_type_nfs}')</run>
</test_case>
<test_case>
   <test_name>Create additional NFS Storage Domain</test_name>
   <test_action>addStorageDomain</test_action>
   <parameters>name='{storage_domain_name[1]}', type='e{storage_dom_type_data}',version='{compatibility_version}', host='{vds[0]}', address='{nfs_standby_address[0]}', path='{nfs_standby_path[0]}', storage_type='e{storage_type_nfs}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>if('{data_center_type}'=='e{storage_type_nfs}')</run>
</test_case>
<test_case>
   <test_name>Create ISO Storage Domain</test_name>
   <test_action>addStorageDomain</test_action>
   <parameters>name='{iso_domain_name[0]}', type='e{storage_dom_type_iso}',version='{compatibility_version}', host='{vds[0]}', address='{tests_iso_domain_address}', path='{tests_iso_domain_path}', storage_type='e{storage_type_nfs}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>END_GROUP: Create_Storages</test_name>
   <test_action/>
   <parameters></parameters>
   <positive>NONE</positive>
   <run/>
</test_case>
<test_case>
   <test_name>START_GROUP: Attach_Master_Data_Domain</test_name>
   <test_action/>
   <parameters></parameters>
   <positive>NONE</positive>
   <run/>
</test_case>
<test_case>
   <test_name>Attach Data Storage Domain to Data Center</test_name>
   <test_action>attachStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}',storagedomain='{storage_domain_name[0]}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>END_GROUP: Attach_Master_Data_Domain</test_name>
   <test_action/>
   <parameters></parameters>
   <positive>NONE</positive>
   <run/>
</test_case>

<test_case>
   <test_name>START_GROUP: Storage_failure</test_name>
   <test_action/>
   <parameters></parameters>
   <positive>NONE</positive>
   <run/>
   <tcms_test_case>47191</tcms_test_case>
</test_case>

<!-- Populate test variables  -->
<test_case>
   <test_name>Get setup hostname</test_name>
   <test_action>getSetupHostname</test_action>
   <parameters>vdc='{host}'</parameters>
   <positive>none</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>hostname->hostname</fetch_output>
</test_case>
<test_case>
   <test_name>Get Master Storage Domain Name</test_name>
   <test_action>findMasterStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}'</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>masterDomain->masterDomain</fetch_output>
</test_case>
<test_case>
   <test_name>Get Master Storage Domain Address</test_name>
   <test_action>getDomainAddress</test_action>
   <parameters>storageDomain=%masterDomain%</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>address->masterDomainAddress</fetch_output>
</test_case>

<test_case>
   <test_name>Create and Start VM</test_name>
   <test_action>createVm</test_action>
   <parameters>vmName='testVm',vmDescription='Test VM',cluster='{cluster_name}',nic='nic1',storageDomainName=%masterDomain%,size=2147483648,diskType='e{disk_type_system}',volumeFormat='e{format_cow}',diskInterface='e{interface_ide}',bootable='true',wipe_after_delete='false',start='true'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Block Outgoing Connection from Host to Storage</test_name>
   <test_action>blockConnection</test_action>
   <parameters>source='{vds[0]}', userName='root', password='{vds_password[0]}', dest=%masterDomainAddress%</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Check if data center status is problematic</test_name>
   <test_action>waitForDataCenterState</test_action>
   <parameters>name='{data_center_name}', state='e{data_center_state_problematic}', timeout=300, sleep=10</parameters>
   <positive>NONE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Check if host status is up</test_name>
   <test_action>waitForHostsStates</test_action>
   <parameters>names='{vds[0]}', states='e{host_state_up}', timeout=300</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Validate Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}', storageDomainName=%masterDomain%, expectedStatus='e{storage_domain_state_inactive}'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Check that host lost SPM</test_name>
   <test_action>checkHostSpmStatus</test_action>
   <parameters>hostName='{vds[0]}'</parameters>
   <positive>FALSE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Unblock Outgoing Connection from Host to Storage</test_name>
   <test_action>unblockConnection</test_action>
   <parameters>source='{vds[0]}', userName='root', password='{vds_password[0]}', dest=%masterDomainAddress%</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Check if data center status is up</test_name>
   <test_action>waitForDataCenterState</test_action>
   <parameters>name='{data_center_name}', state='e{data_center_state_up}', timeout=300, sleep=10</parameters>
   <positive>NONE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Check if host status is up</test_name>
   <test_action>waitForHostsStates</test_action>
   <parameters>names='{vds[0]}', states='e{host_state_up}', timeout=300</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Validate Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}', storageDomainName=%masterDomain%, expectedStatus='e{storage_domain_state_active}'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Check if host SPM</test_name>
   <test_action>checkHostSpmStatus</test_action>
   <parameters>hostName='{vds[0]}'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Stop and Remove Vm</test_name>
   <test_action>removeVm</test_action>
   <parameters>vm='testVm',stopVM='true'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>END_GROUP: Storage_failure</test_name>
   <test_action/>
   <parameters/>
   <positive>NONE</positive>
   <run/>
</test_case>


<test_case>
   <test_name>START_GROUP: SPM_stops_responding</test_name>
   <test_action/>
   <parameters></parameters>
   <positive>NONE</positive>
   <run/>
   <tcms_test_case>68535</tcms_test_case>
</test_case>

<test_case>
   <test_name>Create and Start VM</test_name>
   <test_action>createVm</test_action>
   <parameters>vmName='testVm',vmDescription='Test VM',cluster='{cluster_name}',nic='nic1',storageDomainName=%masterDomain%,size=2147483648,diskType='e{disk_type_system}',volumeFormat='e{format_cow}',diskInterface='e{interface_ide}',bootable='true',wipe_after_delete='false',start='true'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Block Outgoing Connection from RHEVM to Host</test_name>
   <test_action>blockConnection</test_action>
   <parameters>source=%hostname%, dest='{vds[0]}', userName='root', password='{vdc_password}', port='54321'</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Check if host status is non_responsive</test_name>
   <test_action>waitForHostsStates</test_action>
   <parameters>names='{vds[0]}', states='nonresponsive', timeout=660</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Check if host SPM</test_name>
   <test_action>checkHostSpmStatus</test_action>
   <parameters>hostName='{vds[0]}'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Unblock Outgoing Connection from RHEVM to Host</test_name>
   <test_action>unblockConnection</test_action>
   <parameters>source=%hostname%, dest='{vds[0]}', userName='root', password='{vdc_password}', port='54321'</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Wait for datacenter to be up</test_name>
   <test_action>waitForDataCenterState</test_action>
   <parameters>name='{data_center_name}', timeout=300, sleep=10</parameters>
   <positive>None</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Stop and Remove Vm</test_name>
   <test_action>removeVm</test_action>
   <parameters>vm='testVm',stopVM='true'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>END_GROUP: SPM_stops_responding</test_name>
   <test_action/>
   <parameters/>
   <positive>NONE</positive>
   <run/>
</test_case>


<test_case>
   <test_name>START_GROUP: Attach_ISO_Domain</test_name>
   <test_action/>
   <parameters></parameters>
   <positive>NONE</positive>
   <run/>
   <tcms_test_case>50775</tcms_test_case>
</test_case>
<test_case>
   <test_name>Attach ISO Domain to Data Center</test_name>
   <test_action>attachStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}',storagedomain='{iso_domain_name}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Activate ISO Storage Domain</test_name>
   <test_action>activateStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}',storagedomain='{iso_domain_name}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>END_GROUP: Attach_ISO_Domain</test_name>
   <test_action/>
   <parameters></parameters>
   <positive>NONE</positive>
   <run/>
</test_case>

<test_case>
   <test_name>START_GROUP: Block_connection_between_host_DSD_ISO_Two_StorageDomain</test_name>
   <test_action/>
   <parameters></parameters>
   <positive>NONE</positive>
   <run/>
</test_case>
<test_case>
   <test_name>Get Master Storage Domain Name</test_name>
   <test_action>findMasterStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}'</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>masterDomain->masterDomain</fetch_output>
</test_case>
<test_case>
   <test_name>Get Master Storage Domain Address</test_name>
   <test_action>getDomainAddress</test_action>
   <parameters>storageDomain=%masterDomain%</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>address->masterDomainAddress</fetch_output>
</test_case>
<test_case>
   <test_name>Create and Start VM</test_name>
   <test_action>createVm</test_action>
   <parameters>vmName='testVm',vmDescription='Test VM',cluster='{cluster_name}',nic='nic1',storageDomainName=%masterDomain%,size=2147483648,diskType='e{disk_type_system}',volumeFormat='e{format_cow}',diskInterface='e{interface_ide}',bootable='true',wipe_after_delete='false',start='true'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Block Outgoing Connection from Host to Storage Master</test_name>
   <test_action>blockConnection</test_action>
   <parameters>source='{vds[0]}', userName='root', password='{vds_password[0]}', dest=%masterDomainAddress%</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Wait For Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}',storageDomainName=%masterDomain%,expectedStatus='inactive'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Validate Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}', storageDomainName='{iso_domain_name[0]}', expectedStatus='e{storage_domain_state_unknown}'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Validate Host Status</test_name>
   <test_action>waitForHostsStates</test_action>
   <parameters>names='{vds[0]}', states='e{host_state_up}', timeout=300</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Unblock Outgoing Connection from Host to Storage Master</test_name>
   <test_action>unblockConnection</test_action>
   <parameters>source='{vds[0]}', userName='root', password='{vds_password[0]}', dest=%masterDomainAddress%</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Activate Master Storage Domain</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}',storageDomainName=%masterDomain%, expectedStatus='e{storage_domain_state_active}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Sleep</test_name>
   <test_action>sleep</test_action>
   <parameters>seconds=90</parameters>
   <positive>NONE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Block Outgoing Connection from Host to ISO Storage</test_name>
   <test_action>blockConnection</test_action>
   <parameters>source='{vds[0]}', userName='root', password='{vds_password[0]}', dest='{tests_iso_domain_address}'</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Wait For Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}',storageDomainName=%masterDomain%,expectedStatus='active'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Wait For Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}',storageDomainName='{iso_domain_name}',expectedStatus='inactive'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Validate Host Status</test_name>
   <test_action>waitForHostsStates</test_action>
   <parameters>names='{vds[0]}', states='e{host_state_up}', timeout=300</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Unblock Outgoing Connection from Host to ISO Storage</test_name>
   <test_action>unblockConnection</test_action>
   <parameters>source='{vds[0]}', userName='root', password='{vds_password[0]}', dest='{tests_iso_domain_address}'</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Sleep</test_name>
   <test_action>sleep</test_action>
   <parameters>seconds=30</parameters>
   <positive>NONE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Activate ISO Storage Domain</test_name>
   <test_action>activateStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}',storagedomain='{iso_domain_name}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Validate Host Status</test_name>
   <test_action>waitForHostsStates</test_action>
   <parameters>names='{vds[0]}', states='e{host_state_up}', timeout=300</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Validate Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}', storageDomainName=%masterDomain%, expectedStatus='e{storage_domain_state_active}'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Validate ISO Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}', storageDomainName='{iso_domain_name}', expectedStatus='e{storage_domain_state_active}'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Stop and Remove Vm</test_name>
   <test_action>removeVm</test_action>
   <parameters>vm='testVm',stopVM='true'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>END_GROUP: Block_connection_between_host_DSD_ISO_Two_StorageDomain</test_name>
   <test_action/>
   <parameters/>
   <positive>NONE</positive>
   <run/>
</test_case>

<test_case>
   <test_name>START_GROUP: Pool_with_ISO_domain_in_problem</test_name>
   <test_action/>
   <parameters></parameters>
   <positive>NONE</positive>
   <run/>
   <tcms_test_case>50840</tcms_test_case>
</test_case>
<test_case>
   <test_name>Get Master Storage Domain Name</test_name>
   <test_action>findMasterStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}'</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>masterDomain->masterDomain</fetch_output>
</test_case>
<test_case>
   <test_name>Get Master Storage Domain Address</test_name>
   <test_action>getDomainAddress</test_action>
   <parameters>storageDomain=%masterDomain%</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>address->masterDomainAddress</fetch_output>
</test_case>
<test_case>
   <test_name>Create and Start VM</test_name>
   <test_action>createVm</test_action>
   <parameters>vmName='testVm',vmDescription='Test VM',cluster='{cluster_name}',nic='nic1',storageDomainName=%masterDomain% ,size=2147483648,diskType='e{disk_type_system}',volumeFormat='e{format_cow}',diskInterface='e{interface_ide}',bootable='true',wipe_after_delete='false',start='true'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Block Outgoing Connection from Host to ISO Storage Domain</test_name>
   <test_action>blockConnection</test_action>
   <parameters>source='{vds[0]}', userName='root', password='{vds_password[0]}', dest='{tests_iso_domain_address}'</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Wait For Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}',storageDomainName=%masterDomain%,expectedStatus='active'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Wait For Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}',storageDomainName='{iso_domain_name}',expectedStatus='inactive'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Check if host status is up</test_name>
   <test_action>waitForHostsStates</test_action>
   <parameters>names='{vds[0]}', states='e{host_state_up}', timeout=300</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Unblock Outgoing Connection from Host to ISO Storage Domain</test_name>
   <test_action>unblockConnection</test_action>
   <parameters>source='{vds[0]}', userName='root', password='{vds_password[0]}', dest='{tests_iso_domain_address}'</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Wait For Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}',storageDomainName='{iso_domain_name}',expectedStatus='active'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Stop and Remove Vm</test_name>
   <test_action>removeVm</test_action>
   <parameters>vm='testVm',stopVM='true'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>END_GROUP: Pool_with_ISO_domain_in_problem</test_name>
   <test_action/>
   <parameters/>
   <positive>NONE</positive>
   <run/>
</test_case>

<!-- Detach ISO Domain -->
<test_case>
   <test_name>START_GROUP: Detach_ISO_Domain</test_name>
   <test_action/>
   <parameters></parameters>
   <positive>NONE</positive>
   <run/>
   <tcms_test_case>50776</tcms_test_case>
</test_case>
<test_case>
   <test_name>Deactivate ISO Storage Domain</test_name>
   <test_action>deactivateStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}',storagedomain='{iso_domain_name}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Detach ISO Domain from Data Center</test_name>
   <test_action>detachStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}',storagedomain='{iso_domain_name}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>END_GROUP: Detach_ISO_Domain</test_name>
   <test_action/>
   <parameters></parameters>
   <positive>NONE</positive>
   <run/>
</test_case>

<!-- Attach Second Storage Domain -->
<test_case>
   <test_name>START_GROUP: Attach_Second_Domain</test_name>
   <test_action/>
   <parameters></parameters>
   <positive>NONE</positive>
   <run/>
</test_case>
<test_case>
   <test_name>Attach Second Domain to Data Center</test_name>
   <test_action>attachStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}',storagedomain='{storage_domain_name[1]}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Activate ISO Storage Domain</test_name>
   <test_action>activateStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}',storagedomain='{storage_domain_name[1]}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>END_GROUP: Attach_Second_Domain</test_name>
   <test_action/>
   <parameters></parameters>
   <positive>NONE</positive>
   <run/>
</test_case>


<test_case>
   <test_name>START_GROUP: Two_Data_Domains_Master_Failure</test_name>
   <test_action/>
   <parameters></parameters>
   <positive>NONE</positive>
   <run/>
   <tcms_test_case>86148</tcms_test_case>
</test_case>
<test_case>
   <test_name>Get Master Storage Domain Name</test_name>
   <test_action>findMasterStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}'</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>masterDomain->masterDomain</fetch_output>
</test_case>
<test_case>
   <test_name>Get Master Storage Domain Address</test_name>
   <test_action>getDomainAddress</test_action>
   <parameters>storageDomain=%masterDomain%</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>address->masterDomainAddress</fetch_output>
</test_case>
<test_case>
   <test_name>Get NonMaster Storage Domain Name</test_name>
   <test_action>findNonMasterStorageDomains</test_action>
   <parameters>datacenter='{data_center_name}'</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>nonMasterDomains->nonMasterDomain</fetch_output>
</test_case>
<test_case>
   <test_name>Get NonMaster Storage Domain Address</test_name>
   <test_action>getDomainAddress</test_action>
   <parameters>storageDomain=%nonMasterDomain%[0]</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>address->nonMasterDomainAddress</fetch_output>
</test_case>
<test_case>
   <test_name>Create and Start VM</test_name>
   <test_action>createVm</test_action>
   <parameters>vmName='testVm',vmDescription='Test VM',cluster='{cluster_name}',nic='nic1',storageDomainName=%nonMasterDomain%[0],size=2147483648,diskType='e{disk_type_system}',volumeFormat='e{format_cow}',diskInterface='e{interface_ide}',bootable='true',wipe_after_delete='false',start='true'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Block Outgoing Connection from Host to First Storage Domain</test_name>
   <test_action>blockConnection</test_action>
   <parameters>source='{vds[0]}', userName='root', password='{vds_password[0]}', dest=%masterDomainAddress%</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Wait For First Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}', storageDomainName=%masterDomain%, expectedStatus='inactive'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Wait For Second Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}',storageDomainName=%nonMasterDomain%[0] ,expectedStatus='active'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Validate Host Status</test_name>
   <test_action>waitForHostsStates</test_action>
   <parameters>names='{vds[0]}', states='e{host_state_up}', timeout=300</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Validate Data Center Status</test_name>
   <test_action>waitForDataCenterState</test_action>
   <parameters>name='{data_center_name}', state='e{data_center_state_up}', timeout=300, sleep=10</parameters>
   <positive>NONE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Check if host SPM</test_name>
   <test_action>checkHostSpmStatus</test_action>
   <parameters>hostName='{vds[0]}'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Check if Second Storage Domain is a Master</test_name>
   <test_action>isStorageDomainMaster</test_action>
   <parameters>dataCenterName='{data_center_name}',storageDomainName=%nonMasterDomain%[0]</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Unblock Outgoing Connection from Host to First Storage Domain</test_name>
   <test_action>unblockConnection</test_action>
   <parameters>source='{vds[0]}', userName='root', password='{vds_password[0]}', dest=%masterDomainAddress%</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Sleep</test_name>
   <test_action>sleep</test_action>
   <parameters>seconds=20</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Activate First Storage Domain</test_name>
   <test_action>activateStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}',storagedomain=%masterDomain%</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Stop and Remove Vm</test_name>
   <test_action>removeVm</test_action>
   <parameters>vm='testVm',stopVM='true'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>END_GROUP: Two_Data_Domains_Master_Failure</test_name>
   <test_action/>
   <parameters/>
   <positive>NONE</positive>
   <run/>
</test_case>


<test_case>
   <test_name>START_GROUP: Two_Data_Domains_Non_Master_Failure</test_name>
   <test_action/>
   <parameters></parameters>
   <positive>NONE</positive>
   <run/>
   <tcms_test_case>86149</tcms_test_case>
</test_case>
<test_case>
   <test_name>Get setup hostname</test_name>
   <test_action>getSetupHostname</test_action>
   <parameters>vdc='{host}'</parameters>
   <positive>none</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>hostname->hostname</fetch_output>
</test_case>
<test_case>
   <test_name>Get Master Storage Domain Name</test_name>
   <test_action>findMasterStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}'</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>masterDomain->masterDomain</fetch_output>
</test_case>
<test_case>
   <test_name>Get Master Storage Domain Address</test_name>
   <test_action>getDomainAddress</test_action>
   <parameters>storageDomain=%masterDomain%</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>address->masterDomainAddress</fetch_output>
</test_case>
<test_case>
   <test_name>Get nonMaster Storage Domain Name</test_name>
   <test_action>findNonMasterStorageDomains</test_action>
   <parameters>datacenter='{data_center_name}'</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>nonMasterDomains->nonMasterDomain</fetch_output>
</test_case>
<test_case>
   <test_name>Get nonMaster Storage Domain Address</test_name>
   <test_action>getDomainAddress</test_action>
   <parameters>storageDomain=%nonMasterDomain%[0]</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>address->nonMasterDomainAddress</fetch_output>
</test_case>
<test_case>
   <test_name>Create and Start VM</test_name>
   <test_action>createVm</test_action>
   <parameters>vmName='testVm',vmDescription='Test VM',cluster='{cluster_name}',nic='nic1',storageDomainName=%masterDomain%,size=2147483648,diskType='e{disk_type_system}',volumeFormat='e{format_cow}',diskInterface='e{interface_ide}',bootable='true',wipe_after_delete='false',start='true'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Block Outgoing Connection from Host to Standby Storage Domain</test_name>
   <test_action>blockConnection</test_action>
   <parameters>source='{vds[0]}', userName='root', password='{vds_password[0]}', dest=%nonMasterDomainAddress%</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Wait For Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}',storageDomainName=%nonMasterDomain%[0], expectedStatus='e{storage_domain_state_inactive}'</parameters>
   <positive>TRUE</positive>
   <bz>853710</bz>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Validate Host Status</test_name>
   <test_action>waitForHostsStates</test_action>
   <parameters>names='{vds[0]}', states='e{host_state_up}', timeout=300</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Validate Data Center Status</test_name>
   <test_action>waitForDataCenterState</test_action>
   <parameters>name='{data_center_name}', state='e{data_center_state_up}', timeout=300, sleep=10</parameters>
   <positive>NONE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Check if host SPM</test_name>
   <test_action>checkHostSpmStatus</test_action>
   <parameters>hostName='{vds[0]}'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Validate Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}',storageDomainName=%masterDomain%,expectedStatus='e{storage_domain_state_active}'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Check if Storage Domain is still Master</test_name>
   <test_action>isStorageDomainMaster</test_action>
   <parameters>dataCenterName='{data_center_name}',storageDomainName=%masterDomain%</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Unblock Outgoing Connection from Host to Standby Storage Domain</test_name>
   <test_action>unblockConnection</test_action>
   <parameters>source='{vds[0]}', userName='root', password='{vds_password[0]}', dest=%nonMasterDomainAddress%</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Sleep</test_name>
   <test_action>sleep</test_action>
   <parameters>seconds=30</parameters>
   <positive>NONE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Activate Standby Storage Domain</test_name>
   <test_action>activateStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}',storagedomain=%nonMasterDomain%[0]</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Block Outgoing Connection from RHEVM to Host</test_name>
   <test_action>blockConnection</test_action>
   <parameters>source=%hostname%, dest='{vds[0]}', userName='root', password='{vdc_password}', port='54321'</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Check if host status is non_responsive</test_name>
   <test_action>waitForHostsStates</test_action>
   <parameters>names='{vds[0]}', states='nonresponsive', timeout=660</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Validate Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}',storageDomainName=%nonMasterDomain%[0], expectedStatus='e{storage_domain_state_unknown}'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Validate Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}',storageDomainName=%masterDomain%,expectedStatus='e{storage_domain_state_unknown}'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Unblock Outgoing Connection from RHEVM to Host</test_name>
   <test_action>unblockConnection</test_action>
   <parameters>source=%hostname%, dest='{vds[0]}', userName='root', password='{vdc_password}', port='54321'</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Wait for datacenter to be up</test_name>
   <test_action>waitForDataCenterState</test_action>
   <parameters>name='{data_center_name}', timeout=300, sleep=10</parameters>
   <positive>None</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Stop and Remove Vm</test_name>
   <test_action>removeVm</test_action>
   <parameters>vm='testVm',stopVM='true'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>END_GROUP: Two_Data_Domains_Non_Master_Failure</test_name>
   <test_action/>
   <parameters/>
   <positive>NONE</positive>
   <run/>
</test_case>

<test_case>
   <test_name>START_GROUP: Block_connection_One_host_two_DSD_and_Iso</test_name>
   <test_action/>
   <parameters></parameters>
   <positive>NONE</positive>
   <run/>
</test_case>
<test_case>
   <test_name>Attach ISO Storage Domain to Data Center</test_name>
   <test_action>attachStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}',storagedomain='{iso_domain_name}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>NO</run>
</test_case>
<test_case>
   <test_name>Activate ISO Storage Domain</test_name>
   <test_action>activateStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}',storagedomain='{iso_domain_name}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>NO</run>
</test_case>
<test_case>
   <test_name>Get setup hostname</test_name>
   <test_action>getSetupHostname</test_action>
   <parameters>vdc='{host}'</parameters>
   <positive>none</positive>
   <run>NO</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>hostname->hostname</fetch_output>
</test_case>
<test_case>
   <test_name>Get Master Storage Domain Name</test_name>
   <test_action>findMasterStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}'</parameters>
   <positive>TRUE</positive>
   <run>NO</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>masterDomain->masterDomain</fetch_output>
</test_case>
<test_case>
   <test_name>Get Master Storage Domain Address</test_name>
   <test_action>getDomainAddress</test_action>
   <parameters>storageDomain=%masterDomain%</parameters>
   <positive>TRUE</positive>
   <run>NO</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>address->masterDomainAddress</fetch_output>
</test_case>
<test_case>
   <test_name>Get nonMaster Storage Domain Name</test_name>
   <test_action>findNonMasterStorageDomains</test_action>
   <parameters>datacenter='{data_center_name}'</parameters>
   <positive>TRUE</positive>
   <run>NO</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>nonMasterDomains->nonMasterDomain</fetch_output>
</test_case>
<test_case>
   <test_name>Get nonMaster Storage Domain Address</test_name>
   <test_action>getDomainAddress</test_action>
   <parameters>storageDomain=%nonMasterDomain%[0]</parameters>
   <positive>TRUE</positive>
   <run>NO</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>address->nonMasterDomainAddress</fetch_output>
</test_case>
<test_case>
   <test_name>Create and Start VM</test_name>
   <test_action>createVm</test_action>
   <parameters>vmName='testVm',vmDescription='Test VM',cluster='{cluster_name}',nic='nic1',storageDomainName=%nonMasterDomain%[0],size=2147483648,diskType='e{disk_type_system}',volumeFormat='e{format_cow}',diskInterface='e{interface_ide}',bootable='true',wipe_after_delete='false',start='true'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>NO</run>
</test_case>
<test_case>
   <test_name>Block Outgoing Connection from Host to Master Storage Domain</test_name>
   <test_action>blockConnection</test_action>
   <parameters>source='{vds[0]}', userName='root', password='{vds_password[0]}', dest=%masterDomainAddress%</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>NO</run>
</test_case>
<test_case>
   <test_name>Wait For Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}',storageDomainName=%masterDomain%,expectedStatus='inactive'</parameters>
   <positive>TRUE</positive>
   <run>NO</run>
</test_case>
<test_case>
   <test_name>Wait For Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}',storageDomainName=%nonMasterDomain%[0],expectedStatus='active', timeOut=1200</parameters>
   <positive>TRUE</positive>
   <run>NO</run>
</test_case>
<test_case>
   <test_name>Wait For Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}',storageDomainName='{iso_domain_name}',expectedStatus='active'</parameters>
   <positive>TRUE</positive>
   <run>NO</run>
</test_case>
<test_case>
   <test_name>Validate Host Status</test_name>
   <test_action>waitForHostsStates</test_action>
   <parameters>names='{vds[0]}', states='e{host_state_up}', timeout=300</parameters>
   <positive>TRUE</positive>
   <run>NO</run>
</test_case>
<test_case>
   <test_name>Check if Storage Domain is a Master</test_name>
   <test_action>isStorageDomainMaster</test_action>
   <parameters>dataCenterName='{data_center_name}',storageDomainName=%nonMasterDomain%[0]</parameters>
   <positive>TRUE</positive>
   <run>NO</run>
</test_case>
<test_case>
   <test_name>Unblock Outgoing Connection from Host to Master Storage Domain</test_name>
   <test_action>unblockConnection</test_action>
   <parameters>source='{vds[0]}', userName='root', password='{vds_password[0]}', dest=%masterDomainAddress%</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>NO</run>
</test_case>
<test_case>
   <test_name>Sleep</test_name>
   <test_action>sleep</test_action>
   <parameters>seconds=30</parameters>
   <positive>NONE</positive>
   <run>NO</run>
</test_case>
<test_case>
   <test_name>Activate Storage Domain</test_name>
   <test_action>activateStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}',storagedomain=%masterDomain%</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>NO</run>
</test_case>
<test_case>
   <test_name>Stop and Remove Vm</test_name>
   <test_action>removeVm</test_action>
   <parameters>vm='testVm',stopVM='true'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>NO</run>
</test_case>
<test_case>
   <test_name>END_GROUP: Block_connection_One_host_two_DSD_and_Iso</test_name>
   <test_action/>
   <parameters/>
   <positive>NONE</positive>
   <run/>
</test_case>


<test_case>
   <test_name>START_GROUP: Two_Data_Domains_Storage_Failure</test_name>
   <test_action/>
   <parameters></parameters>
   <positive>NONE</positive>
   <run/>
   <tcms_test_case>86150</tcms_test_case>
</test_case>
<test_case>
   <test_name>Deactivate ISO Domain</test_name>
   <test_action>deactivateStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}',storagedomain='{iso_domain_name}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>NO</run>
</test_case>
<test_case>
   <test_name>Detach ISO Domain</test_name>
   <test_action>detachStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}',storagedomain='{iso_domain_name}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>NO</run>
</test_case>
<test_case>
   <test_name>Get setup hostname</test_name>
   <test_action>getSetupHostname</test_action>
   <parameters>vdc='{host}'</parameters>
   <positive>none</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>hostname->hostname</fetch_output>
</test_case>
<test_case>
   <test_name>Get Master Storage Domain Name</test_name>
   <test_action>findMasterStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}'</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>masterDomain->masterDomain</fetch_output>
</test_case>
<test_case>
   <test_name>Get Master Storage Domain Address</test_name>
   <test_action>getDomainAddress</test_action>
   <parameters>storageDomain=%masterDomain%</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>address->masterDomainAddress</fetch_output>
</test_case>
<test_case>
   <test_name>Get nonMaster Storage Domain Name</test_name>
   <test_action>findNonMasterStorageDomains</test_action>
   <parameters>datacenter='{data_center_name}'</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>nonMasterDomains->nonMasterDomain</fetch_output>
</test_case>
<test_case>
   <test_name>Get nonMaster Storage Domain Address</test_name>
   <test_action>getDomainAddress</test_action>
   <parameters>storageDomain=%nonMasterDomain%[0]</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>address->nonMasterDomainAddress</fetch_output>
</test_case>
<test_case>
   <test_name>Create and Start VM</test_name>
   <test_action>createVm</test_action>
   <parameters>vmName='testVm',vmDescription='Test VM',cluster='{cluster_name}',nic='nic1',storageDomainName=%masterDomain%,size=2147483648,diskType='e{disk_type_system}',volumeFormat='e{format_cow}',diskInterface='e{interface_ide}',bootable='true',wipe_after_delete='false',start='true'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Block Outgoing Connection from Host to Master Storage</test_name>
   <test_action>blockConnection</test_action>
   <parameters>source='{vds[0]}', userName='root', password='{vds_password[0]}', dest=%masterDomainAddress%</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Block Outgoing Connection from Host to nonMaster Storage</test_name>
   <test_action>blockConnection</test_action>
   <parameters>source='{vds[0]}', userName='root', password='{vds_password[0]}', dest=%nonMasterDomainAddress%</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Validate Host Status</test_name>
   <test_action>waitForHostsStates</test_action>
   <parameters>names='{vds[0]}', states='e{host_state_up}', timeout=300</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Validate Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}', storageDomainName=%nonMasterDomain%[0], expectedStatus='e{storage_domain_state_unknown}'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Validate Storage Domain Status</test_name>
   <test_action>waitForStorageDomainStatus</test_action>
   <parameters>dataCenterName='{data_center_name}', storageDomainName=%masterDomain%, expectedStatus='e{storage_domain_state_unknown}'</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Validate Data Center Status</test_name>
   <test_action>waitForDataCenterState</test_action>
   <parameters>name='{data_center_name}', state='e{data_center_state_problematic}', timeout=300, sleep=10</parameters>
   <positive>NONE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Unblock Outgoing Connection from Host to Master Storage</test_name>
   <test_action>unblockConnection</test_action>
   <parameters>source='{vds[0]}', userName='root', password='{vds_password[0]}', dest=%masterDomainAddress%</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Unblock Outgoing Connection from Host to nonMaster Storage</test_name>
   <test_action>unblockConnection</test_action>
   <parameters>source='{vds[0]}', userName='root', password='{vds_password[0]}', dest=%nonMasterDomainAddress%</parameters>
   <positive>NONE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Validate Host Status</test_name>
   <test_action>waitForHostsStates</test_action>
   <parameters>names='{vds[0]}', states='e{host_state_up}', timeout=600</parameters>
   <positive>TRUE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Wait for Datacenter to be Up</test_name>
   <test_action>waitForDataCenterState</test_action>
   <parameters>name='{data_center_name}', state='up', timeout=600, sleep=15</parameters>
   <positive>NONE</positive>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Activate Storage Domain</test_name>
   <test_action>activateStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}',storagedomain=%nonMasterDomain%[0]</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Stop and Remove Vm</test_name>
   <test_action>removeVm</test_action>
   <parameters>vm='testVm',stopVM='true'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>END_GROUP: Two_Data_Domains_Storage_Failure</test_name>
   <test_action/>
   <parameters/>
   <positive>NONE</positive>
   <run/>
</test_case>
<test_case>
   <test_name>START_GROUP: Test_Cleanup</test_name>
   <test_action/>
   <parameters/>
   <positive>NONE</positive>
   <run/>
</test_case>
<test_case>
   <test_name>Get master Storage Domain Name</test_name>
   <test_action>findMasterStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}'</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>masterDomain->masterDomain</fetch_output>
</test_case>
<test_case>
   <test_name>Get nonMaster Storage Domain Name</test_name>
   <test_action>findNonMasterStorageDomains</test_action>
   <parameters>datacenter='{data_center_name}'</parameters>
   <positive>TRUE</positive>
   <run>yes</run>
   <vital>TRUE</vital>
   <report>no</report>
   <fetch_output>nonMasterDomains->nonMasterDomain</fetch_output>
</test_case>
<test_case>
   <test_name>Deactivate nonMaster Storage Domain</test_name>
   <test_action>deactivateStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}',storagedomain=%nonMasterDomain%[0]</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Deactivate ISO Domain</test_name>
   <test_action>deactivateStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}',storagedomain='{iso_domain_name}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>NO</run>
</test_case>
<test_case>
   <test_name>Detach nonMaster Storage Domain</test_name>
   <test_action>detachStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}',storagedomain=%nonMasterDomain%[0]</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Detach ISO Domain</test_name>
   <test_action>detachStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}',storagedomain='{iso_domain_name}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>NO</run>
</test_case>
<test_case>
   <test_name>Remove nonMaster Domain</test_name>
   <test_action>removeStorageDomain</test_action>
   <parameters>storagedomain=%nonMasterDomain%[0], host='{vds[0]}', format='true'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Remove ISO Domain</test_name>
   <test_action>removeStorageDomain</test_action>
   <parameters>storagedomain='{iso_domain_name}', host='{vds[0]}', format='true'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Deactivate Master Storage Domain</test_name>
   <test_action>deactivateStorageDomain</test_action>
   <parameters>datacenter='{data_center_name}',storagedomain=%masterDomain%</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Remove Datacenter</test_name>
   <test_action>removeDataCenters</test_action>
   <parameters>datacenters='{data_center_name}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Remove Master Domain</test_name>
   <test_action>removeStorageDomain</test_action>
   <parameters>storagedomain=%masterDomain%, host='{vds[0]}', format='true'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Set host to maintenance</test_name>
   <test_action>deactivateHost</test_action>
   <parameters>host='{vds[0]}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Remove host</test_name>
   <test_action>removeHost</test_action>
   <parameters>host='{vds[0]}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>Remove Cluster</test_name>
   <test_action>removeClusters</test_action>
   <parameters>clusters='{cluster_name}'</parameters>
   <positive>TRUE</positive>
   <vital>TRUE</vital>
   <run>YES</run>
</test_case>
<test_case>
   <test_name>END_GROUP: Test_Cleanup</test_name>
   <test_action/>
   <parameters/>
   <positive>NONE</positive>
   <run/>
</test_case>
</input>
